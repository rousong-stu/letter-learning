# 用户学习记录系统 - 需求与开发计划

## 1. 背景与目标

现有的「AI 词汇短文」模块已能根据每日词表生成短文，但缺乏“学习计划管理 + 学习过程记录 + 掌握情况分析”能力。本次迭代希望围绕“单词书→学习计划→学习记录”建立一套闭环，让用户能够：

- 自主选择官方维护的单词书；
- 根据自身节奏配置每日学习单词量及课程；
- 自动得到分层（Day1、Day2...）的学习计划；
- 在后续学习过程中记录每个单词的学习次数与掌握状态；
- 结合既有的 AI 短文生成能力，形成“计划制定→短文学习→掌握跟踪”的完整路径。

## 2. 需求范围

### 2.1 数据模型

1. **系统单词书表**（由管理员维护）
   - 字段：书名、封面图片、单词（英文）、中文释义、词书描述/标签等。
   - 需支持批量导入（通过管理页面上传）。

2. **用户单词书表**
   - 记录用户选定的单词书、学习课程、每日学习量等配置。
   - 保存分层结果（Day1、Day2...），以便每日抽取词汇。
   - 跟踪每个单词的学习次数、掌握状态（未掌握/已掌握）。
   - 与系统单词书建立引用关系，可按需复制或“写入快照”。

### 2.2 业务流程

0. 管理员上传单词书 → 进入系统单词书库。
1. 学生进入“选择单词书”页面，选择书籍 + 输入学习参数（每日单词量、学习课程）。
2. 保存用户配置时：
   - 将单词书数据写入用户单词书（或建立引用）。
   - 根据总词数与每日单词量执行分层算法（Day1、Day2...）。
3. 系统为每个用户单词记录学习次数、掌握状态。
4. 后续学习业务（每日短文生成、掌握判定、复习策略等）都基于该用户单词书的数据。

## 3. 功能拆解

### 3.1 管理端：单词书管理
- 页面：上传/编辑单词书（含书名、封面、词表）。
- 支持批量导入/导出（CSV/JSON）。
- 为单词书打标签或添加描述，方便用户挑选。

### 3.2 用户端：选择学习计划
- 页面：展示可选单词书（含封面、词数、描述）。
- 表单项：选择单词书、每日学习量、学习课程。
- 提交后创建用户单词书记录，并生成分层。

### 3.3 分层算法
- 输入：词书总词数、每日目标词数。
- 输出：按 Day1/Day2... 分组的词表。
- 约束：每个 Day 的词能较好地组合成短文（需在算法中加入规则，如按主题/词性/词频分布等进行分布优化；可先实现简单版：顺序分组，后续再优化）。

### 3.4 学习记录
- 对每个单词记录：
  - 学习次数（用于复习间隔策略）。
  - 掌握状态（初始未掌握，学习多次后可标记为“已掌握”或“待复习”）。
- 与现有的短文学习流程结合，记录“当天学习完成后”对相关单词的学习次数 + 掌握状态。

### 3.5 后续待细化
- 学习次数累积逻辑（一次短文学习是否算一次，是否有正确率指标等）。
- 掌握判定策略（学习次数达到阈值？用户手动标记？AI 给出建议？）。
- 复习/回顾机制（根据掌握状态和学习次数生成复习任务）。

## 4. 技术设计方向

1. **数据表设计（初稿）**
   - `word_books`：系统单词书表。
   - `word_book_words`：单词书中的单词（可拆表或 JSON 保存）。
   - `user_word_books`：用户与单词书的选择关系 + 学习配置。
   - `user_word_book_words`：用户的每个单词条目（学习次数、掌握状态、Day 信息）。
2. **API 规划**
   - 管理端 CRUD 接口。
   - 用户端选择/查看接口。
   - 分层结果查询接口。
3. **任务/算法**
   - 分层逻辑初步实现（按输入配置生成 Day 切片）。
   - 与短文生成模块对接（按 Day 抽词）。
4. **学习记录逻辑**
   - 与 AI 短文学习流程对接，收集学习行为，更新单词状态。
   - 提供标记“已掌握/未掌握”的接口（暂定用户手动或自动判定）。

## 5. 实施计划（迭代建议）

| 阶段 | 目标 | 关键输出 |
| --- | --- | --- |
| ① 数据模型 & 管理端基础 | 建立系统单词书表及管理页面，完成单词书 CRUD | 表结构 + API + 上传页面 |
| ② 用户选择流程 | 实现用户选择单词书、设置学习参数并创建用户单词书 | 用户端页面 + 创建接口 |
| ③ 分层算法 & 用户词表 | 完成 Day 切分逻辑，并把结果写入用户词表 | 分层算法 + 用户词表数据 |
| ④ 学习记录基础 | 记录学习次数、掌握状态，与短文学习打通 | 学习记录接口/服务 |
| ⑤ 掌握策略优化 | 结合实际情况优化掌握策略、复习计划 | 策略文档 + 二次迭代 |

> 每个阶段都需配合测试/调试以及与前端的联动，确保功能闭环。

## 6. 后续工作

- 与产品/教学侧细化“学习次数 vs 掌握状态”的策略。
- 制定单词书上传格式规范（模板 + 校验规则）。
- 设计数据迁移脚本（若已有单词书资源需导入）。
- 与短文生成模块定义接口协议（Day → 词表 → AI 短文的调用方式）。

---

此文档作为第一版需求与开发计划，后续随着实现进展可持续补充：如精准的表结构、API 定义、分层算法细节、掌握策略等。请确认需求无误后，我们即可按“阶段 ①”开始落地。
